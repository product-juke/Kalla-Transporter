<!-- data/wrapper.xml -->
<odoo>
  <data>
    <!-- Wrapper: kembalikan window action + context dinamis -->
    <record id="action_sale_order_wrapper" model="ir.actions.server">
      <field name="name">Orders (dynamic ctx)</field>
      <field name="model_id" ref="sale.model_sale_order"/>
      <field name="state">code</field>
      <field name="code">
action = env.ref('sale.action_orders').read()[0]
ctx = dict(search_default_filter_to_deliver=1,
           current_company_id=env.user.company_id.id,
           allowed_company_ids=env.user.company_ids.ids,
           portfolio=(env.user.company_id.portfolio_id.name or '').lower())
action['context'] = ctx
action
      </field>
    </record>
    <record id="action_sale_order_quotation_wrapper" model="ir.actions.server">
      <field name="name">Quotation (dynamic ctx)</field>
      <field name="model_id" ref="sale.model_sale_order"/>
      <field name="state">code</field>
      <field name="code">
action = env.ref('sale.action_quotations_with_onboarding').read()[0]
ctx = dict(env.context,
           current_company_id=env.user.company_id.id,
           allowed_company_ids=env.user.company_ids.ids,
           portfolio=(env.user.company_id.portfolio_id.name or '').lower())
action['context'] = ctx
action
      </field>
    </record>
    <record id="action_sale_order_invoice_wrapper" model="ir.actions.server">
      <field name="name">To invoice (dynamic ctx)</field>
      <field name="model_id" ref="sale.model_sale_order"/>
      <field name="state">code</field>
      <field name="code">
action = env.ref('jst_demo_kalla_bju_transporter.action_orders_to_invoice_lms').read()[0]
ctx = dict(create=False, group_by='partner_id',
           current_company_id=env.user.company_id.id,
           allowed_company_ids=env.user.company_ids.ids,
           portfolio=(env.user.company_id.portfolio_id.name or '').lower())
action['context'] = ctx
action
      </field>
    </record>
  </data>
</odoo>
